{
    "app-id": "one.mixin.messenger.desktop",
    "runtime": "org.gnome.Platform",
    "runtime-version": "42",
    "sdk": "org.gnome.Sdk",
    "command": "mixin_desktop",
    "separate-locales": false,
    "finish-args": [
      "--share=ipc",
      "--socket=fallback-x11",
      "--socket=wayland",
      "--device=dri",
      "--socket=pulseaudio",
      "--share=network",
      "--filesystem=home",
      "--talk-name=org.freedesktop.Notifications",
      "--device=all",
      "--env=PATH=/app/bin:/usr/bin",
      "--env=LD_LIBRARY_PATH=."
    ],
    "modules": [
      {
        "name": "mixin_desktop",
        "buildsystem": "simple",
        "only-arches": [
          "x86_64"
        ],
        "build-commands": [
          "mkdir -p FlutterApp",
          "tar -xf mixin-desktop-linux-portable.tar.gz -C FlutterApp",
          "cp -r FlutterApp /app/",
          "chmod +x /app/FlutterApp/mixin_desktop",
          "mkdir -p /app/bin",
          "ln -s /app/FlutterApp/mixin_desktop /app/bin/mixin_desktop",
          "mkdir -p /app/share/metainfo",
          "cp -r one.mixin.messenger.desktop.metainfo.xml /app/share/metainfo/",
          "mkdir -p /app/share/icons/hicolor/scalable/apps",
          "cp -r icon.svg /app/share/icons/hicolor/scalable/apps/one.mixin.messenger.desktop.svg",
          "mkdir -p /app/share/applications",
          "cp -r mixin_desktop.desktop /app/share/applications/one.mixin.messenger.desktop",
          "mkdir -p /app/share/appdata",
          "cp -r one.mixin.messenger.desktop.metainfo.xml /app/share/appdata/"
        ],
        "sources": [
          {
            "type": "file",
            "path": "mixin_desktop.desktop"
          },
          {
            "type": "file",
            "path": "mixin_desktop.png"
          },
          {
            "type": "file",
            "path": "icon.svg"
          },
          {
            "type": "file",
            "path": "mixin-desktop-linux-portable.tar.gz"
          },
          {
            "type": "file",
            "path": "one.mixin.messenger.desktop.metainfo.xml"
          }
        ]
      },
      {
        "name": "ogg",
        "config-opts": [
          "--disable-static",
          "--disable-examples"
        ],
        "sources": [
          {
            "type": "archive",
            "url": "https://downloads.xiph.org/releases/ogg/libogg-1.3.5.tar.gz",
            "sha256": "0eb4b4b9420a0f51db142ba3f9c64b333f826532dc0f48c6410ae51f4799b664"
          }
        ],
        "post-install": [
          "cp /app/lib/libogg.so.0.8.5 /app/FlutterApp/lib/libogg.so.0",
          "ln -s /app/FlutterApp/lib/libogg.so.0 /app/FlutterApp/lib/libogg.so"
        ]
      },
      {
        "name": "opus",
        "config-opts": [
          "--disable-static",
          "--disable-doc",
          "--disable-extra-programs"
        ],
        "sources": [
          {
            "type": "archive",
            "url": "https://archive.mozilla.org/pub/opus/opus-1.3.1.tar.gz",
            "sha256": "65b58e1e25b2a114157014736a3d9dfeaad8d41be1c8179866f144a2fb44ff9d"
          }
        ],
        "post-install": [
          "cp /app/lib/libopus.so.0.8.0 /app/FlutterApp/lib/libopus.so.0"
        ]
      }
    ]
  }